# 反走样

对直线、圆及椭圆这些最基本元素的生成速度和显示质量的改进，在图形处理系统中具有重要的应用价值但它们生成的线条具有明显的“锯齿形” 即会发生走样（Liasing）现象

“锯齿”是“走样”（aliasing）的一种形式。而走样是光栅显示的一种固有性质。产生走样现象的原因是像素本质上的离散性

用于减少或消除走样效果的技术，称为反走样（Antialiasing）技术

由于图形的走样现象对图形的质量有很大影响，几乎所有图形处理系统都要对基本图形进行反走样处理

## 非加权区域采样方法

根据物体的覆盖率（coverage）计算像素的颜色

覆盖率是指某个像素区域被物体覆盖的比例

非加权区域采样方法有两个缺点

1、象素的亮度与相交区域的面积成正比）而与相交区域落在象素内的位置无关，这仍然会导致锯齿效应

2、直线条上沿理想直线方向的相邻两个象素有时会有较大的灰度差
每个像素的权值是一样的，这是它的主要缺点。所以也称非加权区域采样方法



## 加权区域采样方法

这种方法更符合人视觉系统对图像信息的处理方式，反走样效果更好

将直线段看作是具有一定宽度的狭长矩形；当直线段与像素有交时，根据相交区域与像素中心的距离来决定其对象素亮度的贡献

![4.1](img\4.1.png)

直线段对一个像素亮度的贡献正比于相交区域与像素中心的距离设置相交区域面积与像素中心距离的权函数（高斯函数）反映相交面积对整个像素亮度的贡献大小

利用权函数积分求相交区域面积，用它乘以像素可设置的最大亮度值，即可得到该像素实际显示的亮度值

可采用离散计算方法

将一个像素划分为$ n=3×3 $个子象素，加权表可以取作：

$
\begin{bmatrix}
   w_1 & w_2 & w_3 \\
   w_4 & w_5 & w_6 \\
   w_7 & w_8 & w_9
\end{bmatrix}
=\begin{bmatrix}
   1 & 2 & 1 \\
   2 & 4 & 2 \\
   1 & 2 & 1
\end{bmatrix}
$

加权方案：中心子像素的加权是角子像素的4倍，是其它像素的2倍，对九个子像素的每个网格所计算出的亮度进行平均

然后求出所有中心落于直线段内的子像素
最后计算所有这些子像素对原像素亮度贡献之和
