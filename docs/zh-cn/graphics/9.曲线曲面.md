# 曲线曲面

## 曲线曲面基础

### 显示、隐式和参数表示

曲线和曲面的表示方程**有参数表示**和**非参数表示**之分，非参数表示又分为**显式表示**和**隐式表示**

> 对于一个平面曲线，显式表示一般形式是：$y=f(x)$
>
> 在此方程中，一个x值与一个y值对应，所以显式方程不能表示封闭或多值曲线
>
> 如果一个平面曲线方程，表示成$f(x,y)=0$的形式，称之为**隐式表示**。
>
> 隐式表示的优点是易于判断一个点是否在曲线上

显式或隐式表示存在的问题：

- 与坐标轴相关
- 用隐函数表示不直观，作图不方便
- 用显函数表示存在多值性
- 会出现斜率为无穷大的情形

### 参数方程

为了克服以上问题，曲线曲面方程通常表示成参数的形式

假定用t表示参数，平面曲线上任一点P可表示为：
$$
p(t)=[x(t),y(t)]
$$
空间曲线上任意三维点P可表示为：
$$
p(t)=[x(t),y(t),z(t)]
$$
它等价于笛卡儿分量表示：
$$
p(t)=x(t)i+y(t)j+z(t)k
$$
这样，给定一个t值，就得到**曲线上一点**的坐标。

------

假设曲线段对应的参数区间为$[a,b]$，即$a≤t≤b$。

为方便期间，可以将区间$[a,b]$规范化成$[0,1]$，参数变换为：
$$
t'={t-a\over b-a}
$$
参数**曲线**一般可写成：
$$
p=p(t),t∈[0,1]
$$
<br/>

类似地，可把**曲面**表示成为双参数u和v的矢量函数
$$
p(u,v)=p(x(u,v),y(u,v),z(u,v)),\space(u,v)∈[0,1]×[0,1]
$$
<br/>

最简单的参数曲线是**直线段**，端点为P1、P2的直线段参数方程可表示为：
$$
p(t)=p_1+(p_2-p_1)t,t∈[0,1]
$$

### 位置矢量

曲线上任一点的位置矢量可表示为：
$$
P(t)=[x(t),y(t),z(t)]
$$

### 切矢量

选择弧长s作为参数，当Δt→0时，弦长Δs→0，但方向不能趋向于0
$$
T={dP\over ds}=\lim_{Δs→0}{ΔP\over Δs}
$$
根据弧长微分公式有：
$$
(ds)^2=(dx)^2+(dy)^2+(dz)^2
$$
引入参数t，可改写为：
$$
({ds\over dt})^2=({dx\over dt})^2+({dy\over dt})^2+({dz\over dt})^2=|P'(t)|^2
$$

$$
T={dP\over ds}={dP\over dt}·{dt\over ds}={P'(t)\over |P'(t)|}
$$

即T是单位切矢量

### 曲率

切向量求导，求导以后还是一个向量，称为曲率，其几何意义是曲线的单位切向量对弧长的转动率，即刻画这一点的曲线的弯曲程度
$$
k=|T'|=\lim_{Δs→0}|{ΔT\over Δs}|=\lim_{Δs→0}|{T(s+Δs)-T(s)\over Δs}|=\lim_{Δs→0}|{Δθ\over Δs}|
$$
曲率越大，表示曲线的弯曲程度越大

曲率k的倒数$ρ={1\over k}$称为曲率半径。

曲率半径越大，圆弧越平缓；曲率半径越小，圆弧越陡。

### 法矢量

法矢量是与切矢量垂直的向量

N、B构成的平面称为法平面，N、T构成的平面称为密切平面，B、T构成的平面称为从切平面

![9.1.1](img/9.1.1.png)

T（切矢量）、N（主法矢量）和B（副法矢量）构成了曲线上的活动坐标架
$$
B=T×N
$$

### 挠率

空间曲线不但要弯曲，而且还要扭曲，即要离开它的密切平面。

为了能刻画这一扭曲程度，等价于去研究密切平面的法矢量（即曲线的副法矢量）关于弧长的变化率。

挠率$τ$的绝对值等于副法线方向（或密切平面）对于弧长的转动率
$$
|τ|=\lim_{Δs}|{Δθ\over Δs}|
$$

### 插值

自由曲线和自由曲面一般通过少数分散的点生成，这些点叫做“型值点”、“样本点”或“控制点”

给定一组有序的数据点$P_i(i=0,1,2，…n)$，要求构造一条曲线顺序通过这些数据点，称为对这些数据点进行插值(interpolation)，所构造的曲线称为插值曲线

1. 线性插值：假设给定函数$f(x)$在两个不同点x和x2的值，用一个线形函数：$y=ax+b$，近似代替，称为的线性插值函数
2. 抛物线插值：已知三个点的坐标，要求构造一个抛物线函数

### 拟合

构造一条曲线，使之在某种意义下最接近给定的数据点（但未必通过这些点），所构造的曲线为拟合曲线

> 在计算数学中，逼近通常指用一些性质较好的函数近似表示一些性质不好的函数。
>
> 在计算机图形学中，逼近继承了这方面的含义，因此插值和拟合都可以视为逼近

对于逼近样条，连接控制点序列的折线通常被显示出来，以提醒设计者控制点的次序

般将连接有一定次序控制点的直线序列称为控制多边形或特征多边形



### 光顺

指曲线的拐点不能太多（有一、二阶导数等）

对平面曲线而言，相对光顺的条件是

1. 具有二阶几何连续性（$G^2$）

2. 不存在多余拐点和奇异点

3. 曲率变化较小



## 曲线连续性

当许多参数曲线段首尾相连构成一条曲线时，如何保证各曲线段在连接处具有合乎要求的连续性是一个重要问题。

假定参数曲线段$p_i$以参数形式进行描述：
$$
p_i=p_i(t),t∈[t_{i0},t_{i1}]
$$
这里讨论参数曲线两种意义上的连续性：即**参数连续性**和**几何连续性**

### 参数连续性

- 0阶参数连续性

  记作$C^0$连续性，是指曲线的几何位置连接，即第一个曲线段在$t_{i1}$处的x,y,z值与第二个曲线段在$t_{(i+1)0}$处的x,y,z值相等

$$
p_i(t_{i1})=p_{(i+1)}(t_{(i+1)0})
$$

- 1阶参数连续性

  记作$C^1$连续性，指代表两个相邻曲线段的方程在相交点处有相同的一阶导数（切线）：

$$
p_i(t_{i1})=p_{(i+1)}(t_{(i+1)0})\\
且p'_i(t_{i1})=p'_{(i+1)}(t_{(i+1)0})
$$

一阶连续性对数字化绘画及一些设计应用已经足够

- 2阶参数连续性

  记作$C^2$连续性，指两个相邻曲线段的方程在相交点处具有相同的一阶和二阶导数。

  类似地，还可定义高阶参数连续性

对于$C^2$连续性，交点处的切向量变化率相等，即切线从一个曲线段平滑地变化到另一个曲线段

二阶连续性对电影中的动画途径和很多精密CAD需求有用

------

经典的参数连续性在图形学里是不适合的，因为太苛刻，所以引进了几何连续性的概念

汽车曲面的设计美观要求很高，但有时候车身的一条曲线并不是参数连连续的，但人眼看上去已经是很光滑的了，因此需要一种更弱的连续性

### 几何连续性

曲线段相连的另一个连续性条件是几何连续性。

与参数连续性不同的是，它只需曲线段在相交处的参数导数**成比例**即可

- 0阶几何连续性

  记作$G^0$连续性。与0阶参数连续性的定义相同，满足：

$$
p_i(t_{i1})=p_{(i+1)}(t_{(i+1)0})
$$

- 1阶几何连续性

  记作$G^1$连续性。若要求在结合处达到$G^1$连续就是说两条曲线在结合处在满足$G^0$连续的条件下，并有公共的切矢

$$
Q'(0)=αP'(1)\space(α>0)
$$

- 2阶几何连续性

  记作$G^2$连续性。就是说两条曲线在结合处在满足$G^1$连续的条件下，并有公共的曲率



!>**一阶导数相等和有公共切向量这两个概念差别是什么？**导数相等是大小方向都相等，而公共切矢意味着方向相同但大小不等。所谓参数连续意味着导数相等，导数相等意味着两个切向量，不但方向相等而且长度也相等。*条件减弱了*