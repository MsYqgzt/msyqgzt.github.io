# 数据解析
- 聚焦爬虫：爬取页面中指定的页面内容
- 编码流程
   - 指定URL
   - 发起请求
   - 获取相应数据
   - $\color{red}数据解析$
   - 持久化存储

## 数据解析的方法/分类
- 正则
- bs4
- xpath(语言通用性强)

## 数据解析的原理概述
解析的局部文本内容都会在**标签之间**或**标签对应的属性中**进行存储

因此可以这么做：

1. 进行指定标签的定位

2. 标签或者标签对应的属性中存储的数据值进行提取（解析）

## 正则表达式方法

### 常用的正则表达式

|          符号          |                             含义                             |              举例              |
| :--------------------: | :----------------------------------------------------------: | :----------------------------: |
|      **单字符：**      |                                                              |                                |
|           .            |                    除了换行以外的所有字符                    |                                |
|           []           |                   匹配集合中的任意一个字符                   |          [aoe];[a-w]           |
|           \d           |                             数字                             |             [0-9]              |
|           \D           |                            非数字                            |                                |
|           \w           |                   数字、字母、下划线、中文                   |                                |
|           \W           |                             非\w                             |                                |
|           \s           | 所有的空白字符包，包括空格、制表符、换页符等<br/>等价于【\f\n\r\t\v】 |                                |
|           \S           |                            非空白                            |                                |
|     **数量修饰：**     |                                                              |                                |
|           *            |                         任意多次 >=0                         |                                |
|           +            |                         至少一次 >=1                         |                                |
|           ?            |                      可有可无 0次或1次                       |                                |
|          {m}           |                           固定m次                            |                                |
|         {m,n}          |                            m-n次                             |                                |
|       **边界：**       |                                                              |                                |
|           ^            |                         以某符号开头                         |             ^begin             |
|           $            |                         以某符号结尾                         |              end$              |
|       **分组：**       |                                                              |                                |
|          (ab)          |                         a和b字符成组                         |                                |
|     **贪婪模式：**     |                                                              |                                |
|           .*           |                                                              |                                |
| **非贪婪(惰性)模式：** |                                                              |                                |
|          .*?           |                                                              |                                |
|                        |                                                              |                                |
|          re.I          |                          忽略大小写                          |                                |
|          re.M          |                           多行匹配                           |                                |
|          re.S          |                           单行匹配                           |                                |
|         re.sub         |                    在指定内容替换指定字符                    | re.sub(正则, 替换内容, 字符串) |
|                        |                                                              |                                |

### 正则练习

```python
import re
# 提取python
re.findall('python', key)[0]

# 提取hello world
key = "<html><h1>hello world</h1></html>"
re.findall('<h1>(.*)</h1>', key)[0]

# 提取170
string = '我喜欢身高为170的女孩'
re.findall('\d+', string)

# 提取http://和https://
key = 'lalala<hTml>hello</HtMl>hahaha'  # 输出<hTml>hello</HtMl>
re.findall('<[Hh][Tt][mM][lL]>(.*)</[Hh][Tt][mM][lL]>', key)

# 提取hit.
key = 'bobo@hut.edu.com'
re.findall('h.*?\.', key)

# 匹配sas和saas
key = 'saas and sas and saaas'
re.findall('sa{1,2}s', key)
```

### 实例

项目需求：爬取糗事百科指定页面的糗图，并将其保存到指定文件夹中

```python
import requests
# 爬取图片数据
url = 'https://pic.qiushibaike.com/system/pictures/12172/121721055/medium/9OSVY4ZSU4NN6T7V.jpg'
# text(字符串数据)、content(二进制数据)、json()
img_data = requests.get(url=url).content

# 持久化存储
with open('./qiutu.jpg', 'wb') as fp:
    fp.write(img_data)
```

