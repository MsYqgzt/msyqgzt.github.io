# 作业调度的时间计算
##  批处理作业调度算法
> **先来先服务（FCFS - First Come First Served）调度算法**
>
> 选择*最先进入后备队列的*作业装入内存。
>
> 优点：比较容易实现。
>
> 缺点：不区分作业长短，对短小作业十分不利；不顾及轻重缓急；对时间要求紧迫的作业不能做到急事急办。


> **最短作业优先（SJF - Shortest Job First）调度算法**
>
> 从后备作业中选择*运行时间最短的*作业装入内存。
>
> 优点：照顾短作业用户的利益，提高系统吞吐量，降低此作业的平均周转时间。
>
> 缺点：推迟长作业运行，可能出现饥饿现象。估计运行时间本身有可能不太准确。


> **最高响应比优先（HRF - Highest Response First）**调度算法
>
> 定义：作业的响应比 $ R={t_w+t_s \over t_s}={t_w \over t_s}+1\approx{t_w \over t_s} $
>
> $ t_w $ - 作业的等待时间， $ t_s $ - 作业的估计运行时间 
>
> 优点：折衷考虑到作业进入系统的先后次序，又顾及到作业的运行长度。
>
> 缺点：每次调度都要计算每个作业的响应比，开销大。


> **最高优先级优先（HPF - Highest Priority First）**调度算法
>
> 该算法每次总是选择后备作业中优先级最高的作业装入内存。
>
> 当一个作业进入系统，系统根据用户级别、用户租金、作业类别、作业运行时间要求等为作业赋予一个优先级。
>
> HPF是一种比较灵活的调度算法，优先级可以根据需要灵活确定。
>
> HPF经常作为基于作业运行紧迫性的一种调度方案。


> **均衡调度算法（理想型算法）**
> 
> 根据内存容量的限制，选择一组资源互补型的作业装入。
> 
> 目的：在作业运行期间，尽可能提高CPU和各种设备之间的并行度。

## 作业调度性能的衡量标准
- 系统吞吐量高
  - 单位时间内系统完成的工作量称吞吐量。这是作业调度追求的第一目标。
  - 吞吐量Q 与 作业的平均周转时间T 的关系：平均周转时间T越小，系统吞吐量Q就越大
  
- 对短作业优惠
  - 这一准则主要为了吸引中小用户使用计算机。
  - 为了描述系统对短小作业的优惠程度，可使用作业的*平均带权周转时间W*作为评价参数。
  
- 其他指标
  - 处理机利用率高
  - 响应时间有保证
  - 优先权有保证
  - 截止时间有保证
  - 资源均衡利用

## 作业调度时间算法
> $n$ - 单位时间内的作业数量
>
> $t_{bi}$ - 第i个作业提交的时间
>
> $t_{fi}$ - 第i个作业的完成时间
>
> $t_{si}$ - 第i个作业的运行（占用CPU）时间
>
> **作业周转时间**
>
> $T_i＝t_{fi}-t_{bi}$
>
> **作业的平均周转时间**
>
> $T={1 \over n}\displaystyle\sum_{i=1}^n(t_{fi}-t_{bi})$
>
> **作业的平均带权周转时间**
>
> $W={1 \over n}\displaystyle\sum_{i=1}^n(t_{fi}-t_{bi})/t_{si}$
>
> $响应比＝{等待时间＋运行时间\over运行时间}$

------

## 算法举例
> 两个程序，其中A请求系统服务时间5s，B请求系统服务时间为100s，设第0到第5秒前，CPU运行C进程。在第1秒时B进入系统内存，第2秒时A进入内存。当CPU空闲，需要调度进程时根据不同的算法选择A或B。
>
> **问：分别计算FCFS算法下和SJF算法下，A和B的周转时间、带权周转时间。**

1. FCFS：先进先运行
| Job  | 进入时间 | 运行时间 | 开始时刻 | 完成时刻 | 周转时间  | 带权周转时间 |
| :--: | :------: | :------: | :------: | :------: | :-------: | :----------: |
|  A   |  **2**   |    5     |   105    | **110**  | 100-2=108 |  108/5=21.6  |
|  B   |  **1**   |   100    |    5     | **105**  | 105-1=104 | 104/100=1.04 |

- 根据上表信息
  - 周转时间$ =(104+108)/2\\=106 $
  - 带权周转时间$ =(21.6+1.04)/2\\=11.32 $

2. SJF：最短作业优先
| Job  | 进入时间 | 运行时间 | 开始时刻 | 完成时刻 | 周转时间  | 带权周转时间 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| A | **2** | 5 | 5 | **10** | 10-2=8 | 8/5=1.6 |
| B | **1** | 100 | 10 | **110** | 110-1=109 | 109/100=1.09 |

- 根据上表信息
  - 周转时间$ =(8+109)/2\\=58.5 $
  - 带权周转时间$ =(1.6+1.09)/2\\=1.345 $